<% layout('Admin/layouts/boilerPlate') -%>

<!--Container Main start-->
 <div class="application bg-light">
    <h4>Add Draw Flag Game</h4>
    <%- include ('./partials/SuccessError'); -%>
    <form class="add-quiz-form row needs-validation" action="/game-management/draw-flags-games" method="POST" enctype="multipart/form-data" novalidate>
    <div class="row" >
      <div class="col-md-6">
        <input name="gameName" placeholder="Please Enter Game Name" type="text" class="form-control" id="validationTooltip03" required>
      </div>
      <div class="col-md-6">
        <input name="gameDetail" placeholder="Please Enter Game Detail" type="text" class="form-control" id="validationTooltip03" required>
      </div>
      <div class="col-md-6 mt-3">
        <label for="countryImg" class="form-label">Country Image</label>
        <div class="add-quiz-state-image">
            <input class="add-quiz-image-input formFile form-control" type="file" id="countryImg" name="countryImg" required>
            <!-- <button onclick="clearImage()"  style="width: 40px;background-color: #a8171a;color: white;" class="btn" type="button" ><i class="fa-solid fa-xmark"></i></button> -->
        </div>
      </div> 
    </div>
    <hr>
     <div id="setNewForm">
        <div class="form-data">
          <div class="row">
            <div class="col-md-6 position-relative mt-3">
                <select class="form-select" name="country" id="countryIDAdd" onchange="selectedCountry()" required> 
                  <%data.forEach(item => {%>  
                    <option hidden>Please Select Country</option>                     
                    <option value="<%=item.country%>"><%=item.country%></option>  
                  <%})%>
                </select> 
              </div>
              <div class="col-md-6 position-relative mt-3">
                <input readonly name="flagUrl" placeholder="Flag Url" type="text" class="form-control" id="flagUrlAdd" required>
                <div class="invalid-tooltip">
                  Please provide Flags Url.
                </div>
              </div>
              <div class="col-md-6 position-relative mt-3">
                <div class="mt-3">
                  <input readonly name="flagDetails" placeholder="Flags Details" type="text" class="form-control" id="flagDetailsAdd" required>
                  <div class="invalid-tooltip">
                    Please provide Flags Details.
                  </div>
                </div>
                <div class="mt-3">  
                    <label class="form-label">Selected Colors</label>
                    <select multiple name="correctColors" id="correctColorsAdd" class="form-control" style="height: 91px !important;" required>
                      <option hidden>Please Select Colors</option>                     
                    </select> 
                </div>
                <div class="mt-3">
                  <input readonly name="arrangement" placeholder="Selected Arrangement" type="text" class="form-control" id="arrangementAdd" required>
                  <div class="invalid-tooltip">
                    Please provide Arrangement.
                  </div>
                </div> 
              </div>
              <div class="col-md-6 position-relative mt-3">
                <div id="shapeDiv" class="mt-3 p-2">
                  <img id="shapeImgID" src="" alt="image" class="" width="180" height="91">
                </div> 
                <input readonly name="shapeImg" placeholder="Flag shape" type="text" class="form-control" id="shapeImgAdd" required>
              </div>
          </div>
          <hr>
          </div>
          </div>
        <div class="col-12 mt-4">
            <button class="btn" style="background-color: #a8171a;color: white;" type="submit">Submit</button>
            <button style="float: right; border-radius: 50%; background-color: #a8171a;color: white;" class="show-form btn " type="button"><i class="fa-solid fa-plus"></i></button>
        </div>
      </form>

    <!-- Add Multiple Questions -->
      <div style="display: none;" >
        <div id="addNewForm" class="form-data">
            <div class="row">
                <div class="col-md-6 position-relative mt-4">
                    <input name="arrangements" placeholder="Please Enter Country Name" type="text" class="form-control" id="validationTooltip03" required>
                    <div class="invalid-tooltip">
                      Please provide a Country Name.
                    </div>
                  </div>
                  <div class="col-md-6 position-relative mt-4">
                    <input name="arrangements" placeholder="Please Enter Flags Details" type="text" class="form-control" id="validationTooltip03" required>
                    <div class="invalid-tooltip">
                      Please provide a Flags Details.
                    </div>
                  </div>
                <div class="col-md-6 position-relative mt-4">
                    <div class="container" style="padding: 0%;">
                        <label class="form-label">Select Colors</label>
                        <select multiple data-multi-select-plugin required>
                            <option value="red">Red</option>
                            <option value="pink">Pink</option>
                            <option value="black">Black</option>
                            <option value="yellow">Yellow</option>
                            <option value="white">White</option>
                            <option value="blue">Blue</option>
                           <option value="grey">Grey</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-6 position-relative mt-4">
                    <div class="container" style="padding: 0%;">
                        <label class="form-label">Select Arrangement</label>
                        <select multiple data-multi-select-plugin required>
                            <option value="Three Stripes">Three Stripes</option>
                            <option value="Two Stripes">Two Stripes</option>
                        </select>
                    </div>
                </div>
              <div class="col-md-6 position-relative mt-4" >
                <input class="add-quiz-image-input form-control" type="file" name="flag" id="formFile" onchange="preview()" required>
              </div>
              </div>
              <hr>
                </div>
                </div>
      </div> 
</div>
<script>
  async function selectedCountry()
  {
    const countryName = document.getElementById("countryIDAdd").value;
    const response = await fetch(`/game-management/draw-flags-games/countryName/${countryName}`);
    const data = await response.json(); 
   
    document.getElementById("flagUrlAdd").value = data.flagUrl;
    document.getElementById("flagDetailsAdd").value = data.flagDetails;
    document.getElementById("shapeImgID").src = `/upload-images/${data.shapeImg}`;
    document.getElementById("shapeDiv").style.width = "195px";
    document.getElementById("shapeDiv").style.backgroundColor = "black";
    document.getElementById("shapeImgAdd").value = data.shapeImg;
    var selectedColors = '';
    data.correctColors.forEach(element => {  
      selectedColors += `<option selected value="${element}">${element}</option>`;      
    }); 
    document.getElementById("correctColorsAdd").innerHTML = selectedColors;
    document.getElementById("arrangementAdd").value = data.arrangement;  
  }
</script>  
