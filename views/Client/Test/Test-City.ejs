<% layout('Client/layouts/boilerPlate') -%>

<main>
  <!-- breadcrumb-area -->
  <section
    class="breadcrumb-area d-flex align-items-center"
    style="background-image: url(https://testpod-bucket.s3.amazonaws.com/pages/test-bg.png)"
  >
    <div class="container">
      <div class="row align-items-center">
        <div class="col-xl-12 col-lg-12">
          <div class="breadcrumb-wrap text-left">
            <div class="breadcrumb-title">
              <h2>MVC Practice Tests</h2>
              <div class="breadcrumb-wrap">
                <nav aria-label="breadcrumb">
                  <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                      <a href="/">Home</a>
                    </li>
                    <li class="breadcrumb-item active" aria-current="page">
                      States
                    </li>
                    <li class="breadcrumb-item active" aria-current="page">
                      <%=data[0]?.stateName%>
                    </li>
                  </ol>
                </nav>
              </div>
            </div>
          </div>
        </div>
      
    </div>
  </section>
</main>

<section
  id="about"
  class="about-area about-p pt-120 pb-120 p-relative"
  style="
    background: url(https://testpod-bucket.s3.amazonaws.com/pages/about-bg-aliments.png) no-repeat;
    background-position: center center;
  ">
  <div class="quiz-citys">
    <h2 class="font-weight-bold mb-2"><%=data[0]?.stateName.toUpperCase()%></h2>
    <p class="font-italic text-muted mb-4 text-center">
      
    </p>
    <div class="row quiz-card">
      <%data.forEach(value => {%> 
      <a onclick="storeLog('<%=value._id%>')" href="/dmv-test/<%=value.stateName%>/<%=value.quizName.toLowerCase().replace(/ /g,"-")%>" class="card quiz-card-item col-md-3" style="width: 17rem; padding: 0%">
        <img src="/upload-images/<%=value.stateImg%>" class="card-img-top card-img" alt="..." />
        <div class="card-body">
          <h5 class="card-title quiz-card-title" style="text-align: start;padding: 0px;"><%=value.quizName%></h5>
          <!-- <p class="card-text">
            <%=value.quizDetail%>
          </p> -->
          <div class="card-question-number">
            <div style="display: flex;gap: 5px;align-items: center;flex-wrap: wrap;">
              <p class="card-total-scorce"><%=value.questions.length%></p>
              <p class="card-question" >questions</p>
            </div>
            <div>
            </div>
          </div>
        </div>
      </a>
      <%})%>
    </div>
  </div>
</section> 


<% if (pages> 0) { %>
  <nav aria-label="Page navigation example">
    <ul class="pagination justify-content-end">
      <% if (page==1) { %>
        <li class="page-item disabled">
          <span class="page-link">Previous</span>
        </li>
        <% } else { %>
        <li class="page-item">
          <a class="page-link" href="/dmv-test/<%=data[0].stateName%>?page=<%= Number(page) - 1 %>">Previous</a>
        </li>
        <% } %>
        <% var i = (Number(page) > 5 ? Number(page) - 4 : 1) %>
        <% if (i !== 1) { %>
          <li class="page-item disabled"><a class="page-link active">...</a></li>
        <% } %>
        <% for (; i <=(Number(page) + 4) && i <=pages; i++) { %>
          <% if (i==page) { %>
            <li class="page-item"><a class="page-link active"><%= i %></a></li>
          <% } else { %>
            <li class="page-item"><a class="page-link" href="/dmv-test/<%=data[0].stateName%>?page=<%= i %>"><%= i %></a></li>
          <% } %>
          <% if (i==Number(page) + 4 && i < pages) { %>
            <li class="page-item"><a class="page-link">...</a></li>
          <% } %>
        <% } %>
        <% if (page==pages) { %>
          <li class="page-item disabled">
            <a class="page-link">Next</a>
          </li>
        <% } else { %>
          <li class="page-item">
            <a class="page-link" href="/dmv-test/<%=data[0].stateName%>?page=<%= Number(page) + 1 %>">Next</a>
          </li>
        <% } %>
          
    </ul>
  </nav>
  <% } %>


<script>
  async function storeLog(id) {
      const counter = 1;
      const response = await fetch(`/track-quiz/${id}`, {
        method: 'POST',
        body: JSON.stringify({
          views:counter
        }),
        headers: {
          'Content-type': 'application/json; charset=UTF-8',
        }
      }); 
      console.log(response);
    }
</script>

<script src="/client/js/about.js"></script>

